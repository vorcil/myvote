var getPasswordStrength=function(c){var a=0;var e=/.*[a-z].*/;var d=/.*[A-Z].*/;var b=/.*[0-9].*/;var f=/.*[ !"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~].*/;if(e.test(c)){a++}if(d.test(c)){a++}if(b.test(c)){a++}if(f.test(c)){a++}return a};$.validator.addMethod("passwordFormat",function(a,b){if(a.length>11){return true}else{return getPasswordStrength(a)>2}},"Please enter a valid password.");$.validator.addMethod("containsOnlyRecognisedCharacters",function(a){var b=a.length;while(b--){if(getPasswordStrength(a[b])<1){return false}}return true},"The password you have chosen contains special characters that are not recognised by the system.");$.validator.addMethod("checkRepeatingCharacters",function(a){var b=/^(.)\1+$/;return !b.test(a.toLowerCase())},"The password you have chosen is invalid.");$.validator.addMethod("checkLeadingTrailingWhitespace",function(a){return a.length==$.trim(a).length},"The password you have chosen is invalid.");passwordValidation={rules:{newPassword:{required:function(){removeServerErrors("newPassword:input");return true},minlength:7,passwordFormat:true,containsOnlyRecognisedCharacters:true,checkRepeatingCharacters:true,checkLeadingTrailingWhitespace:true},userPassword:{required:function(){removeServerErrors("userPassword:input");return true},minlength:7,passwordFormat:true},existingPassword:{required:true,minlength:7,passwordFormat:true},confirmPassword:{equalTo:"[id$='newPassword:input']"}},messages:{newPassword:{required:messages.password.required,minlength:messages.password.invalidLength,passwordFormat:function(c,b){var a=getPasswordStrength($(b).val());return a<=1?messages.password.create.oneCharacterType:messages.password.create.twoCharacterTypes},containsOnlyRecognisedCharacters:messages.password.containsUnrecognisedCharacters,checkRepeatingCharacters:messages.password.invalidPassword,checkLeadingTrailingWhitespace:messages.password.invalidPassword},userPassword:{required:messages.password.required,minlength:messages.password.invalidLength,passwordFormat:function(c,b){var a=getPasswordStrength($(b).val());return a<=1?messages.password.existing.oneCharacterType:messages.password.existing.twoCharacterTypes}},existingPassword:{required:messages.password.required,minlength:messages.password.invalidLength,passwordFormat:function(c,b){var a=getPasswordStrength($(b).val());return a<=1?messages.password.existing.oneCharacterType:messages.password.existing.twoCharacterTypes}},confirmPassword:{equalTo:messages.password.notequal}}};